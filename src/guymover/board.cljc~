(ns guymover.board
  (:require [guymover.util :as u]))

;;;; The guymover board!
;;;; A board consists of dimensions,
;;;; which equal the number of players
;;;; plus extracells.

(def ^:const extracells
  "Add this to the number of players
  to get the board size."
  3)

(defn add-guy
  ""
  [{:keys [dims guys] :as board
    :or {dims [extracells extracells]
         guys {}}}
   guy-name]
  {:pre [(not (guys guy-name))]}
  (let [colors (set (map :color guys))
        new-color (u/clr-gen colors)
        new-id (u/new-uuid)
        dim (+ extracells 1 (count guys))
        new-guy {:name guy-name
                 :color new-color
                 :id new-id
                 :position [(dec dim) (dec dim)]}]
    (-> board
        (assoc :dims [dim dim])
        (update :guys #(assoc % new-id  new-guy)))))
